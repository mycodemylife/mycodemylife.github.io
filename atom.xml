<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://mycodemylife.github.io</id>
    <title>七彩旋律</title>
    <updated>2020-08-20T09:09:23.856Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://mycodemylife.github.io"/>
    <link rel="self" href="https://mycodemylife.github.io/atom.xml"/>
    <subtitle>一闪一闪亮晶晶</subtitle>
    <logo>https://mycodemylife.github.io/images/avatar.png</logo>
    <icon>https://mycodemylife.github.io/favicon.ico</icon>
    <rights>All rights reserved 2020, 七彩旋律</rights>
    <entry>
        <title type="html"><![CDATA[php证件照换底色]]></title>
        <id>https://mycodemylife.github.io/post/php_change/</id>
        <link href="https://mycodemylife.github.io/post/php_change/">
        </link>
        <updated>2020-08-20T09:08:27.000Z</updated>
        <content type="html"><![CDATA[<pre><code class="language-php">&lt;?php
//背景图和原图需要保持宽高要保持一样，这里的示例原图用的是蓝色背景
init();
function init(){
    $old = '1.png';
    $new = '2.png';
    //创建一个png透明图
    $img = imagecreatefrompng($old);
    setpng($img,$old,$new);
}
function setpng($imgid,$filename,$savename){
    $bg = 'bg.png';//背景图
    $new = imagecreatefrompng($bg);//创建一个png透明图
    list($width,$height)=getimagesize($filename);//获取长和宽
    $white = imagecolorallocate($imgid,1,155,215);//选择一个替换颜色。这里是绿色
    cleancolor($imgid,$white);
    imagecolortransparent($imgid,$white);//把选择的颜色替换成透明
    imagecopymerge($new,$imgid,0,0,0,0,$width,$height,100);//合并图片
    imagepng($new,$savename);//保存图片
    imagedestroy($imgid);//销毁
    imagedestroy($new);
    echo '&lt;img src=&quot;'.$savename.'&quot;&gt;';
}
function cleancolor($imgid,$color){
    $width = imagesx($imgid);//获取宽
    $height = imagesy($imgid);//获取高
    for($i=0;$i&lt;$width;$i++){
        for($k=0;$k&lt;$height;$k++){
            //对比每一个像素
            $rgb = imagecolorat($imgid,$i,$k);
            $r = ($rgb &gt;&gt; 16)&amp;0xff;//取R
            $g = ($rgb &gt;&gt; 8)&amp;0xff;//取G
            $b = $rgb&amp;0xff;//取B
            $randr = 1.5;
            $randg = 1;
            $randb=1;
            //蓝色RGB大致的位置。替换成绿色
            if($r&lt;=65*$randr &amp;&amp; $g&lt;=225*$randg &amp;&amp; $b&lt;=255*$randb &amp;&amp; $b*$randb&gt;=100){
                //如果能够精确的计算出要保留位置的，这里可以写绝对的数字
                if($i&gt;=$width/2 &amp;&amp; $i&lt;=$width/2 &amp;&amp; $k&gt;=$height/2 &amp;&amp; $k&lt;=$height/2){
                    
                }else{
                    //改变颜色
                    imagesetpixel($imgid,$i,$k,$color);
                }
            }
        }
    }
}

$old指的是要处理的图片，指定为png格式
$new指的是处理后输出的图片名
$bg指的是背景图
</code></pre>
<p>😘 Enjoy~</p>
]]></content>
    </entry>
</feed>